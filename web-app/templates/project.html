<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>MGM - {{projectName}}</title>

    <!-- Custom fonts for this template-->
    <link href="{{ url_for('static',filename='vendor/fontawesome-free/css/all.min.css') }}" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="{{ url_for('static',filename='css/sb-admin-2.min.css') }}" rel="stylesheet">

    <style>
		#cy {
		width: 80%;
		height: 4000px;
		display: block;
        border-style: solid;

		}
        #nodes{
            width: 20%;
            background-color: white;
            height: 100%;
            padding: 20px;
        }

	</style>

    <script src="{{ url_for('static',filename='js/cytoscape.min-3.22.1.js') }}"></script>

</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-text mx-3">MGM Admin Console</div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item active">
                <a class="nav-link" href="/">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Basic 
            </div>
            
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-fw fa-cog"></i>
                    <span>Add New Project</span></a>
            </li>

        

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                List of Project
            </div>
            {% for project in listOfProject %}
            {% if projectName==project %}
                <li class="nav-item active">
                {% else %}
                <li class="nav-item">
                {% endif %}
                <a class="nav-link" href="/project/{{project}}">
                <i class="fas fa-fw fa-folder"></i>
                <span>{{ project }}</span></a>
            </li>
            {% endfor %}


        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            {% if func=='main' %}
                            <li class="nav-item" style="font-weight: bold;">
                           <a class="nav-link" style="color: black;"  href="/project/{{project}}">Graph</a>
                           </li>
                           {% else %}
                           <li class="nav-item">
                           <a class="nav-link"  href="#">Graph</a>
                            </li>
                           {% endif %}

                          {% if func=='id1' %}
                             <li class="nav-item" style="font-weight: bold;">
                            <a class="nav-link" style="color: black;"  href="?f=id1">Min-Set-Cover</a>
                            </li>
                            {% else %}
                            <li class="nav-item">
                            <a class="nav-link"  href="?f=id1">Min-Set-Cover</a>
                             </li>
                            {% endif %}

                            {% if func=='id2' %}
                            <li class="nav-item" style="font-weight: bold;">
                           <a class="nav-link" style="color: black;"  href="?f=id2&c=15">Cost of Source in GET Set-Cover</a>
                           </li>
                           {% else %}
                           <li class="nav-item">
                           <a class="nav-link"  href="?f=id2&c=15">Cost of Source in GET Set-Cover</a>
                            </li>
                           {% endif %}

                           {% if func=='id3' %}
                           <li class="nav-item" style="font-weight: bold;">
                          <a class="nav-link" style="color: black;"  href="?f=id3">Min Computational Capacity Set Cover</a>
                          </li>
                          {% else %}
                          <li class="nav-item">
                          <a class="nav-link"  href="?f=id3">Min Computational Capacity Set Cover</a>
                           </li>
                          {% endif %}

                          {% if func=='minSetCovByMetric' %}
                           <li class="nav-item" style="font-weight: bold;">
                          <a class="nav-link" style="color: black;"  href="?f=minSetCovByMetric">Min-Set-Cover By Metrics</a>
                          </li>
                          {% else %}
                          <li class="nav-item">
                          <a class="nav-link"  href="?f=minSetCovByMetric">Min-Set-Cover By Metrics</a>
                           </li>
                          {% endif %}
                         
                          <li class="nav-item">
                            <a class="nav-link" href="#"></a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" href="#"></a>
                          </li>

                        </ul>
                      </div>

                  

                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="row">
                    <div class="coll" id="nodes">No selected nodes</div>
                    <div class="coll" id="cy"></div>

                </div>
               

                
                            
                
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy;</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->



    <!-- Bootstrap core JavaScript-->
    
    <script src="{{ url_for('static',filename='js/jquery-3.6.1.min.js') }}"></script>
    <script src="{{ url_for('static',filename='vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>

    <!-- Core plugin JavaScript-->
    <script src="{{ url_for('static',filename='vendor/jquery-easing/jquery.easing.min.js') }}"></script>

    <!-- Custom scripts for all pages-->
    <script src=" {{ url_for('static',filename='js/sb-admin-2.min.js') }}"></script>


    <script>

		var cy = cytoscape({

		container: document.getElementById('cy'), // container to render in

        

        boxSelectionEnabled: true,
        autounselectify: true,

        style: cytoscape.stylesheet()
            .selector('node')
            .style({
                'content': 'data(name)',
                'background-color': '#000',
                'type': 'rectangle'
            })
            .selector('edge')
            .style({
                'content': 'data(weight)',
                'curve-style': 'bezier',
                'target-arrow-shape': 'triangle',
                'width': 0.5,
                'line-color': '#000',
                'target-arrow-color': '#000'
            })
            .selector('.bluenode')
            .style({
                'background-color': '#6161fc',
                'line-color': '#6161fc',
                'target-arrow-color': '#6161fc',
                'transition-property': 'background-color, line-color, target-arrow-color',
                'transition-duration': '0.5s'
            })
            .selector('.rednode')
            .style({
                'background-color': '#fc6161',
                'line-color': '#fc6161',
                'target-arrow-color': '#fc6161',
                'transition-property': 'background-color, line-color, target-arrow-color',
                'transition-duration': '0.5s'
            })
            .selector('.greennode')
            .style({
                'background-color': '#66fc61',
                'line-color': '#66fc61',
                'target-arrow-color': '#66fc61',
                'transition-property': 'background-color, line-color, target-arrow-color',
                'transition-duration': '0.5s'
            })
            .selector('.violetnode')
            .style({
                'background-color': '#d861fc',
                'line-color': '#d861fc',
                'target-arrow-color': '#d861fc',
                'transition-property': 'background-color, line-color, target-arrow-color',
                'transition-duration': '0.5s'
            })
            .selector('.selected')
            .style({
                'background-color': '#b80000',
                'line-color': '#b80000',
                'target-arrow-color': '#b80000',
                'transition-property': 'background-color, line-color, target-arrow-color',
                'transition-duration': '0.5s'
            })
            


		});
       
		var jsonGrpah = $.getJSON("{{ url_for('static', filename=projectNameFile) }}", function(data){
		
			cy.add(cy.json(data));
            elems = cy.nodes()[1]['_private']['data']['name']
        
            cy.batch(function(){
                cy.nodes().forEach(element => {
                    catelem = element['_private']['data']['category']
                    if(typeof catelem !== "undefined")
                    {
                        iid =  element['_private']['data']['id']
                        
                        if(catelem == 'Defense Metrics'){
                            cy.$('#'+iid).addClass('bluenode')
                        }
                        if(catelem == 'Attack Metrics'){
                            cy.$('#'+iid).addClass('rednode')
                        }
                        if(catelem == 'Situation Metrics'){
                            cy.$('#'+iid).addClass('greennode')
                        }
                        if(catelem == 'Vulnerability Metrics'){
                            cy.$('#'+iid).addClass('violetnode')
                        }
                    } 
                    
                });
            });
            
            var jsonGrpah2 = $.getJSON("{{ url_for('static', filename=projectNameFileNew) }}", function(data){
                cy.add(cy.json(data));
                cy.animate({
                     pan: { x: 150, y: 100 },
                        zoom: 1
                        }, {
                        duration: 2000
                        });
            });
		});
        cy.autounselectify(false);
        
        selectedElem = []

        cy.on('click', 'node', function (evt) {
            iid = '#'+evt.target.id()
            	
            classes =  cy.$(iid).classes()
            if(classes.includes('selected')){
                cy.$(iid).removeClass('selected')
                var index = selectedElem.indexOf(evt.target.id());
                if (index !== -1) {
                    selectedElem.splice(index, 1);
                }
            }else{
                cy.$(iid).addClass('selected')
                selectedElem.push(evt.target.id())
            }
        updateHTML(selectedElem)
        console.log(selectedElem)
    });

    function updateHTML(selectedElem){
        text = 'The Selected node are:<br>'
        selectedElem.forEach(element => {

            text = text + element+';<br>'
        });
        console.log(text)
        $('#nodes').html(text)
    }
    


    
	

	</script>

    

</body>

</html>